<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hasil TKA 2025 - SMAN 52 Jakarta</title>

<script src="xlsx.full.min.js"></script>

<style>
body{font-family:Arial;background:#f5f6fa;display:flex;justify-content:center;align-items:center;min-height:100vh;margin:0}
.card{background:#fff;padding:2rem;max-width:720px;width:100%;border-radius:12px;box-shadow:0 10px 25px rgba(0,0,0,.08)}
input,button{width:100%;padding:.6rem;margin-bottom:.8rem;font-size:1rem}
button{background:#0066cc;color:#fff;border:none;border-radius:6px}
.nilai{border-bottom:1px dashed #ccc;padding:.3rem 0}
</style>
</head>

<body>
<div class="card">
<h2>Hasil TKA 2025<br>SMAN 52 Jakarta</h2>

<input id="nama" placeholder="Nama Lengkap">
<input id="tgl" type="date">
<button onclick="cek()">Cek Hasil</button>

<div id="hasil"></div>
</div>

<script>
let DATA = [];

fetch("data_tka.xlsx")
.then(res => res.arrayBuffer())
.then(buf => {
  const wb = XLSX.read(buf, {type:"array"});
  const ws = wb.Sheets[wb.SheetNames[0]];
  DATA = XLSX.utils.sheet_to_json(ws);
});

function cek(){
  const nama = document.getElementById("nama").value.trim().toUpperCase();
  const tgl = document.getElementById("tgl").value;
  const h = document.getElementById("hasil");

  const s = DATA.find(r =>
    r["Nama Lengkap"].toUpperCase() === nama &&
    r["Tanggal Lahir"] === tgl
  );

  if(!s){
    h.innerHTML = "<span style='color:red'>Data tidak ditemukan</span>";
    return;
  }

  let out = `<b>Nama:</b> ${s["Nama Lengkap"]}<br>
             <b>Tanggal Lahir:</b> ${s["Tanggal Lahir"]}<hr>
             <b>Nilai TKA:</b>`;

  for(const k in s){
    if(k !== "Nama Lengkap" && k !== "Tanggal Lahir"){
      out += `<div class="nilai"><b>${k}</b>: ${s[k]}</div>`;
    }
  }
  h.innerHTML = out;
}
</script>
</body>
</html>
